#include <stdio.h>
#include "system.h"
/* * === FUNCTION ====================================
 * * Name: dpy_decode
 * * Description: 数码管译码函数，将0~9译成数码管段码值
 * * =================================================== */
unsigned char dpy_decode(unsigned char number)
{
	switch(number)
	{
	 case 0x0:return 0x03;
	 case 0x1:return 0x9F;
	 case 0x2:return 0x25;
	 case 0x3:return 0x0D;
	 case 0x4:return 0x99;
	 case 0x5:return 0x49;
	 case 0x6:return 0x41;
	 case 0x7:return 0x1F;
	 case 0x8:return 0x01;
	 case 0x9:return 0x09;
	 default:return 0xff;
	}
	return 0xff;
}

/* * === FUNCTION ====================================
 * * Name: dpy_display
 *  * Description: 数码管显示函数
 *   * =================================================== */
void dpy_display(unsigned int number)
{
	int *dpy_num = (int*)SMG_CONTROLLER_0_BASE;
	int i;
	int delay;
	unsigned int j=100000;
	unsigned char display[6];
	for (i=5;i>=0;i--)
	{
		display[i]= number / j;
		number -= j * display[i];
		j /= 10;
	}
	*(dpy_num+1) = (dpy_decode(display[0]) << 8) + dpy_decode(display[1]);
	*dpy_num = (dpy_decode(display[2]) << 24) +(dpy_decode(display[3]) << 16) +(dpy_decode(display[4]) << 8) + dpy_decode(display[5]);
}

/* * === FUNCTION ====================================
 * * Name: main
 * * Description: 主函数，显示一个数据到数码管上
 * * =================================================== */
int main()
{
	printf("Hello from Nios II!\n");
	int i=1;

	dpy_display(123456);    //显示数码管的数字

	return 0;
}

